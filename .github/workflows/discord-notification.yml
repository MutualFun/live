name: Discord Notifications 

on: workflow_dispatch

jobs:
  check-for-live-content:
    runs-on: ubuntu-latest
    steps:
      - name: Check out the Project Board
        uses: actions/github-script@v3
        id: set-result
        with:
          github-token: ${{secrets.GITHUB_TOKEN}}
          script: | 
            const fs = require('fs')

            const result = await github.projects.getCard({
              card_id: 56801078,
            });

            const issue = await github.request(result.data.content_url)
            fs.writeFileSync('result.json', JSON.stringify(issue));
      - name: Upload issue artifact
        uses: actions/upload-artifact@v2
        with:
          name: issue-data
          path: result.json
  

  send-discord-notifcation:
    needs: ['check-for-live-content']
    runs-on: ubuntu-latest
    steps:
      - name: Download issue artifact
        uses: actions/download-artifact@v2
        with:
          name: issue-data
      - name: Set download as variable
      - run: |
          export FOO=bar
          echo "::set-env name=FOO::$FOO"
      - run: echo $FOO
      #       - name: Discord notification
      #         env:
      # #           DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
      # #         uses: Ilshidur/action-discord@master
      # #         with:
      # #           args: 'Hello World'
